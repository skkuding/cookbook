# Docker

ì´ë²ˆ ì£¼ì°¨ë¶€í„°ëŠ” ë³¸ê²©ì ìœ¼ë¡œ ì¸í”„ë¼ë‹¤ìš´(!) ì£¼ì œë¥¼ ê³µë¶€í•´ë³¼ ê±°ì˜ˆìš”. ìš”ì¦˜ ë°°í¬í•  ë•Œ ë¹¼ë†“ì„ ìˆ˜ ì—†ëŠ” DockerëŠ” ì‘ìš©í”„ë¡œê·¸ëž¨ì„ ê²©ë¦¬í•´ì£¼ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•´ì¤ë‹ˆë‹¤. ê°€ë³ê³  ë¹ ë¥¸ ê°€ìƒë¨¸ì‹ ìœ¼ë¡œ ìƒê°í•˜ë©´ ë  ê±°ì˜ˆìš”.

ì´ë²ˆ ì£¼ì°¨ì—ëŠ” Dockerê°€ ë¬´ì—‡ì¸ì§€ì™€ ì™œ ì“°ëŠ”ì§€ë¥¼ ì´í•´í•˜ê³ , Docker CLIì™€ Docker Composeë¡œ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•´ë³¼ ê±°ì˜ˆìš”.

## ê³µë¶€í•  ë‚´ìš© ðŸ“š

### 1. Docker

ì„œë²„ë¥¼ ë°°í¬í•  ë•Œ ê°€ìž¥ ë¬¸ì œë¥¼ ë§Žì´ ì¼ìœ¼í‚¤ëŠ” ë¶€ë¶„ ì¤‘ í•˜ë‚˜ëŠ” ê°œë°œ í™˜ê²½ê³¼ ì„œë²„ í™˜ê²½ì˜ ì°¨ì´ìž…ë‹ˆë‹¤. ì´ë¥¼ ë§‰ê¸° ìœ„í•´ì„œ ê¸°ì¡´ì—ëŠ” VMWare ê°™ì€ ê°€ìƒ ë¨¸ì‹ ì„ ì£¼ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤ë©´, ìš”ì¦˜ì€ ë” ë¹ ë¥´ê³  ê°€ë²¼ìš´ ì»¨í…Œì´ë„ˆì¸ Dockerë¥¼ ë§Žì´ ì‚¬ìš©í•©ë‹ˆë‹¤. DockerëŠ” í™˜ê²½ ë¬¸ì œë‚˜ ë³´ì•ˆ, ì„±ëŠ¥ ë“± ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤ë‹ˆë‹¤.

ìš°ì„  [Docker ì„¤ì¹˜ ê°€ì´ë“œ](../reference/Install%20Docker.md)ë¥¼ ì°¸ê³ í•´ì„œ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.

- Dockerê°€ ë¬´ì—‡ì¸ì§€, ê¸°ì¡´ì˜ ê°€ìƒë¨¸ì‹ ê³¼ì˜ ì°¨ì´ì ì„ ì´í•´í•©ë‹ˆë‹¤.
- Docker CLIë¥¼ ì´ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.  
  (ì•Œì•„ë³¼ ëª…ë ¹ì–´: run, ps, stop, rm, exec, logs, images, pull)
- Docker Composeë¥¼ ì´ìš©í•˜ì—¬ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.  
  (ì•Œì•„ë³¼ ì†ì„±: image, build, command, ports, volumes, environment, depends_on, restart, networks)
- Dockerfileì„ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê³  ë°°í¬í•´ë´…ë‹ˆë‹¤.  
  (ì•Œì•„ë³¼ ì†ì„±: FROM, RUN, COPY, CMD, ENV, WORKDIR, ENTRYPOINT, ADD, HEALTHCHECK)

> ë” ê³µë¶€í•´ë³´ë©´ ì¢‹ì„ ê²ƒë“¤(ì„ íƒ): Docker Best Practices

#### ì°¸ê³  ìžë£Œ

- **[ë…¸ë§ˆë“œì½”ë” "Docker ê°€ ì™œ ì¢‹ì€ì§€ 5ë¶„ì•ˆì— ì„¤ëª…í•´ì¤Œ" (ì•½ 5ë¶„)](https://youtu.be/chnCcGCTyBg?si=FWg6DVKfOjTCgCOb)**: ë„ì»¤ê°€ ë¬´ì—‡ì¸ì§€, ì™œ ì“°ëŠ”ì§€ë¥¼ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ì¤ë‹ˆë‹¤.
- **[subicura "ì´ˆë³´ë¥¼ ìœ„í•œ ë„ì»¤ ì•ˆë‚´ì„œ" (ê¸€)](https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html)**: ë„ì»¤ ìž…ë¬¸ ë•Œ ë¹¼ë†“ì„ ìˆ˜ ì—†ëŠ” ìžë£Œë¡œ ì–¸ê¸‰ë˜ëŠ” ê¸€ìž…ë‹ˆë‹¤. ì´ ì„¸ íŽ¸ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ìžˆê³ , íŠœí† ë¦¬ì–¼ë„ ì°¨ê·¼ì°¨ê·¼ ì„¤ëª…ë˜ì–´ìžˆì–´ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. ([2íŽ¸](https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html), [3íŽ¸](https://subicura.com/2017/02/10/docker-guide-for-beginners-create-image-and-deploy.html))
- **[Freecodecamp "Docker Tutorial for Beginners" (ì•½ 2ì‹œê°„)](https://youtu.be/fqMOX6JJhGo?si=rud5_lyC_N53ZO7x)**: ì˜ìƒì´ ë” íŽ¸í•œ ë¶„ë“¤ì„ ìœ„í•œ ê°•ì˜ìž…ë‹ˆë‹¤.

### 2. Nginx

NginxëŠ” ì›¹ ì„œë²„ë¡œ, ìš”ì¦˜ì€ ëŒ€ë¶€ë¶„ì˜ ì„œë²„ê°€ Nginxë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. NginxëŠ” ë§¤ìš° ë¹ ë¥´ê³  í™•ìž¥ì„±ì´ ì¢‹ì•„ì„œ ë§Žì´ ì‚¬ìš©ë©ë‹ˆë‹¤. Nginxì˜ ì£¼ ìš©ë„ì¸ reverse proxyì™€ load balancingì„ ë°°ìš°ê³ , Nginxë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ë‹ˆë‹¤.

- Nginxì˜ ì—­í• ê³¼ íŠ¹ì§•ì„ ì´í•´í•©ë‹ˆë‹¤.
- Proxy(reverse vs. forward)ì™€ Load Balancingì˜ ê°œë…ì„ ì´í•´í•©ë‹ˆë‹¤.
- Nginxë¥¼ ì„¤ì¹˜í•˜ê³  ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.

> [!NOTE]  
> Nginx ì—°ìŠµì€ Dockerë¡œ í•˜ëŠ” ê±¸ ê¶Œìž¥í•©ë‹ˆë‹¤! ë¡œì»¬ì— ì„¤ì¹˜í•œ NginxëŠ” ê¸°ì¡´ì— ì„¤ì¹˜ëœ ì„œë²„ì™€ ì¶©ëŒí•  ìˆ˜ ìžˆê³ , ì›ë³µì´ ì–´ë ¤ìš¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. [Nginx ì´ë¯¸ì§€](https://hub.docker.com/_/nginx)ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ê³ , ë¡œì»¬ì˜ nginx.conf íŒŒì¼ì„ ë³¼ë¥¨ìœ¼ë¡œ ì—°ê²°í•´ë³´ì„¸ìš”.

#### ì°¸ê³  ìžë£Œ

- **[ìš°ì•„í•œí…Œí¬ "í”¼ì¼€ì´ì˜ Nginx" (ì•½ 16ë¶„)](https://youtu.be/6FAwAXXj5N0?si=G7JUxntHPVx7L8gb)**: ì›¹ ì„œë²„ì˜ ì—­ì‚¬ì™€ Nginxì˜ íŠ¹ì§•ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ì¤ë‹ˆë‹¤.
- **[Nginx ê³µì‹ ë¬¸ì„œ](https://nginx.org/en/docs/beginners_guide.html)**: Nginx ê³µì‹ ë¬¸ì„œìž…ë‹ˆë‹¤. ì˜ì–´ë¡œ ë˜ì–´ìžˆì§€ë§Œ, ë§¤ìš° ìžì„¸í•˜ê²Œ ì„¤ëª…ë˜ì–´ìžˆì–´ì„œ ì°¸ê³ í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. (Beginner's guide ì½ì–´ì£¼ì„¸ìš”!)
- **["dockerë¡œ nginx ì„¤ì •í•˜ê¸°" (ê¸€)](https://middleearth.tistory.com/49)**: Dockerë¡œ Nginxë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•œ ê¸€ìž…ë‹ˆë‹¤.

#### ë” ê³µë¶€í•˜ë©´ ì¢‹ì„ ì„œë¹„ìŠ¤: Caddy (ì„ íƒ)

CaddyëŠ” Nginxë³´ë‹¤ ì‚¬ìš©í•˜ê¸° ì‰½ê³  ë¹¨ë¼ìš”! ìŠ¤ê¾¸ë”©ì—ì„œë„ ìµœê·¼ë¶€í„° Caddyë¥¼ ì‚¬ìš©í•˜ê³  ìžˆì–´ìš”. ë‹¤ë§Œ Nginxì— ë¹„í•´ ê²€ìƒ‰í•  ìˆ˜ ìžˆëŠ” ìžë£Œê°€ ì ì–´ì„œ, ìž…ë¬¸ìžê°€ ë°°ìš°ê¸°ì— ì¡°ê¸ˆ ë” ì í•©í•œ Nginxë¥¼ ìŠ¤í„°ë”” ë‚´ìš©ì— ë„£ì—ˆìŠµë‹ˆë‹¤. Caddyì— ê´€ì‹¬ì´ ìžˆë‹¤ë©´ ê³µë¶€í•´ë³´ë©´ ì¢‹ê³ , ì‹¤ìŠµë„ Caddyë¡œ êµ¬í˜„í•˜ë©´ ë” ì¢‹ìŠµë‹ˆë‹¤! ([Caddy ê³µì‹ ë¬¸ì„œ](https://caddyserver.com/docs/))

## í”„ë¡œì íŠ¸ ì‹¤ìŠµ ðŸŽˆ

ì§€ë‚œ ë²ˆì— ë§Œë“  Express ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ Dockerize(Docker Imageë¥¼ ë§Œë“¤ì–´ì„œ ë°°í¬)í•´ë´…ë‹ˆë‹¤. Expressë§Œ Dockerizeí•˜ë©´ ìž¬ë¯¸ì—†ì£ ...! Nginxë„ Dockerizeí•´ì„œ Express ì•žì— ë‘ê³ , Nginxê°€ Expressë¡œ ìš”ì²­ì„ ì „ë‹¬í•˜ë„ë¡ ì„¤ì •í•´ë´…ë‹ˆë‹¤. (Reverse Proxyë¡œ ì“¸ ê±°ì˜ˆìš”!)

```mermaid
flowchart LR
  subgraph Docker Compose
    Nginx -- localhost:3000 --> Node.js
  end
  Client -- localhost:8000 --> Nginx
```

- docker-compose.yml íŒŒì¼ì„ ìž‘ì„±í•´ì£¼ì„¸ìš”.
- Express ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ìˆ˜ì •í•´ì£¼ì„¸ìš”!
  - Express ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬íŠ¸ë¥¼ 3000ë²ˆìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”.
  - HTMLì„ ë°˜í™˜í•˜ëŠ” endpointëŠ” ì—†ì• ì£¼ì„¸ìš”. Nginxê°€ HTMLì„ ë°˜í™˜í•˜ë„ë¡ í•´ì£¼ì„¸ìš”! (`GET /`)
  - Express ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¼ìš°íŒ…ì„ ìˆ˜ì •í•´ì£¼ì„¸ìš”. (`GET /*` â†’ `GET /api/*`)
- Express ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ Dockerizeí•©ë‹ˆë‹¤. [ê³µì‹ Node.js Docker Image](https://hub.docker.com/_/node/)ë¥¼ Dockerfileì—ì„œ `FROM`ìœ¼ë¡œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
- Nginx ì´ë¯¸ì§€ëŠ” ê³µì‹ ì´ë¯¸ì§€ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. nginx.confì™€ index.html íŒŒì¼ì„ ë³¼ë¥¨ìœ¼ë¡œ ì—°ê²°í•´ì£¼ì„¸ìš”. (week2.htmlì˜ ì´ë¦„ì„ ë³€ê²½í•´ì£¼ì„¸ìš”!)

> [!NOTE] Dockerizeëž€?  
> ì„œë¹„ìŠ¤ ì½”ë“œì™€ ì˜ì¡´ì„±ì„ containerì— ë‹´ëŠ” Dockerfileì„ ìž‘ì„±í•˜ê³ , Docker CLIë¥¼ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì„ Dockerizeë¼ê³  í•©ë‹ˆë‹¤.

> **Challenge! ðŸ”¥ (ì„ íƒ)**  
> Express ì»¨í…Œì´ë„ˆë¥¼ ë‘ ê°œ ë„ìš°ê³ , Nginx(ë˜ëŠ” Caddy)ì—ì„œ load balancing ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë³´ì„¸ìš”.  
> Hint: Node.jsì˜ í¬íŠ¸ë¥¼ ì™¸ë¶€ë¡œ ë…¸ì¶œí•˜ë©´ ì¶©ëŒì´ ë‚˜ê² ì£ ? ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê³  ì»¨í…Œì´ë„ˆë¼ë¦¬ ìš”ì²­ì„ ì£¼ê³ ë°›ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”!

```mermaid
flowchart LR
  subgraph Docker Compose
    Nginx -- localhost:3000 --> A("Node.js(1)")
    Nginx -- localhost:3000 --> B("Node.js(2)")
  end
  Client -- localhost:8000 --> Nginx
```
